CC = {CC}
CFLAGS = -Wall -O2 -g -I.
LDFLAGS = -lm
PREFIX = {PREFIX}
MODULES = jobqueue.o schedule.o support.o vplist.o

jobqueue:	$(MODULES)
	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $(MODULES)

%.o:	%.c
	$(CC) $(CFLAGS) -c $<

jobqueue.o:	jobqueue.c jobqueue.h vplist.h schedule.h support.h version.h
schedule.o:	schedule.c schedule.h jobqueue.h vplist.h support.h
support.o:	support.c support.h
vplist.o:	vplist.c vplist.h

install:	jobqueue
	install jobqueue "$(PREFIX)/bin/"

check:	
	cd selftests && ./selftest.sh

clean:	
	rm -f jobqueue *.o
